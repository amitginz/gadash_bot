# 📋 מערכת דוחות עבודות גד"ש

מערכת מבוססת Python ו-Flask להזנת, צפייה וניהול עבודות קבלנות של גד"ש, עם ממשק Web נוח, שמירה ל-Excel ו-Google Sheets, ואינטגרציה עם בוט טלגרם — **בקובץ יחיד משולב**.

---

## 🚀 תכונות עיקריות

- 🌐 ממשק Web מלא להזנת עבודות, סינון לפי תאריך / לקוח, עריכה ומחיקה
- 📤 ייצוא קובץ Excel עם כל הנתונים (`works.xlsx`)
- 📥 ייבוא נתונים מקובץ Excel
- 🔎 סינון מתקדם בטבלה הראשית
- ☁️ שמירה אוטומטית גם ל-Google Sheets
- 🤖 **בוט טלגרם משולב** באותו קובץ עם הממשק web

---

## 🧰 דרישות מערכת

- Python 3.9+
- ספריות:
  - Flask
  - pandas
  - openpyxl
  - gspread
  - oauth2client
  - python-telegram-bot

להתקנה:
```bash
pip install -r requirements.txt
```

---

## 🗂 מבנה הפרויקט

```
project/
├── app.py               # קובץ יחיד שמריץ גם את ה-Web וגם את בוט הטלגרם
├── works.xlsx           # קובץ הנתונים (נוצר אוטומטית)
├── credentials.json     # מפתח של Google Service Account
├── templates/
│   ├── index.html       # דף ראשי (רשימה + סינון)
│   ├── add.html         # טופס הוספה
│   ├── edit.html        # עריכת שורה קיימת
│   └── import.html      # ייבוא קובץ Excel
└── static/              # קבצי CSS/JS (אופציונלי)
```

---

## ▶️ הרצה מקומית

```bash
python app.py
```

- יופעל גם השרת Flask (בכתובת http://127.0.0.1:5000)
- וגם הבוט טלגרם יפעל במקביל באותו תהליך

---

## 🤖 בוט טלגרם (משולב)

- תומך בהזנת עבודה לפי שלבים
- שומר ל־Excel וגם ל־Google Sheets
- כולל תפריט, ייצוא קובץ, דוח שבועי, סינון לפי תאריך / לקוח

**הגדרת טוקן:** יש להוסיף לקובץ `.env` או כמשתנה סביבה:
```
BOT_TOKEN=your-telegram-token-here
```

---

## 🧪 שימוש ב-Google Sheets (אופציונלי)

1. צור פרויקט חדש ב-Google Cloud Console
2. צור Service Account וייצא קובץ `credentials.json`
3. שתף את הגיליון עם הכתובת של החשבון (editor)
4. ודא שהשם `Gadash Data` תואם לקובץ שלך

---

## 📦 ייצוא וייבוא

- `/export` — הורדה של קובץ הנתונים
- `/import` — העלאת קובץ Excel קיים (יתווסף לנתונים הקיימים)

---

## 🛡️ שיקולים אבטחתיים

המערכת כרגע **ללא הגבלת גישה**. להוספת סיסמה או הגבלת משתמשים – יש להוסיף אימות בהמשך.

---

## 📝 קרדיטים

פותח על ידי עמית גינזברג 🙌 בעזרת ChatGPT
